---
title:  服务注册中心
lang: zh-cn
---

## 服务注册中心原理

在分布式系统里的注册中心。原理是将部署服务的机器地址记录到注册中心，服务消费者在有需求的时候，只需要查询注册中心，输入提供的服务名，就可以得到地址，从而发起调用。

在微服务架构下，主要有三种角色：**服务提供者（RPC Server）**、**服务消费者（RPC Client）** 和 **服务注册中心（Registry）**，三者的交互关系请看下面这张图:

![service-registry1.png](/assets/imgs/service-registry1.png)

**RPC Server** 提供服务，在启动时，根据配置文件指定的服务注册中心配置信息，向 **Registry** 注册自身的服务路由，并向**Registry**定期发送心跳汇报存活状态。

**RPC Client** 调用服务，在启动时，根据配置文件指定的服务注册中心配置信息，向 **Registry** 订阅服务，把**Registry**返回的服务节点列表缓存在本地内存中，并与 **RPC Sever** 建立连接。

当 **RPC Server** 节点发生变更时，**Registry**会同步变更，**RPC Client** 感知后会刷新本地内存中缓存的服务节点列表。

**RPC Client** 从本地缓存的服务节点列表中，基于负载均衡算法选择一台 **RPC Sever** 发起调用。

::: tip 提示
1. 对于一个微服务应用来说,在集群中,它既可以作为**RPC Sever**,也可能作为**RPC Client**，主要是看在rpc通信过程中，是提供服务的一方，还是调用服务的一方。

:::

## 服务路由

在lms框架中,服务提供者将会以**服务路由**为单位向服务注册中心注册路由信息。每一个被实现了的服务条目都会生成一条**服务路由**。

服务路由的格式如下：

```json
{
    
}
```

## 使用zookeeper作为服务注册中心

